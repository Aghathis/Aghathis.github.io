<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>world guess</title>
	<script src='jquery.js'></script>
	<link href="https://fonts.googleapis.com/css?family=Amaranth&amp;display=swap" rel="stylesheet">
	<style>
		*{padding:0;margin:0;font-family:Amaranth;}
	
		#modal{
			text-align:center;
			margin: 0 auto;
			padding:10px;
			width: 75vw;
			border-radius:10px;
			box-shadow:1px 2px 10px #000;
		}
		
		
		button.wrong{background-color:#F33!important;}
		button.good{background-color:#5F6!important;}
		button{cursor:pointer;vertical-align: top;border-radius: 3px;margin:10px 5px;padding:10px;
			border:none;outline:none;background-color:#EEE;border-radius;10px;transition:0.2s ease;}
		button:hover{background-color:#CCC;transition:0.2s ease;color:#FFF;}
		button:active{background-color:#333;outline:none;}
		
		.qflag{
			box-shadow:0px 0px 4px #CCC;
		}
		
		.score{
			position:fixed;
			top:10px;
			left:10px;
			padding:10px;
			border-radius:10px;
			border:1px solid #000;
		}
		
		.masquerreponse{
			visibility:hidden;
		}
		
		#question{
			padding:10px;
		}
		
	</style>
	
</head>
<body>
	<div id='score'>score : 0/0</div>

	<div id='modal'>
		<div id='question'></div>
		<hr style='margin:20px'>
		<div id='reponse'></div>
	</div>
	
	<script src='world.js'></script>
	<script src='tools.js'></script>
	<script>
	var listOrder = [];
	var badAnswerList = [];
	var indexOrder = 0;
	var worldLength = 0;
	var questionwanted = "nom";
	var answerwanted = "capitale";
	
	$(document).ready(function(){
		worldLength = 5;//world.lengthsubempty("nom");
		for(var i = 0;i<worldLength;i++)
			listOrder.push(i);
		listOrder.shuffle();
		Guesser(questionwanted,answerwanted);
	});

	function getNextCountry(){
		if(indexOrder >= listOrder.length){
			indexOrder = 0;
			listOrder = badAnswerList;
			badAnswerList=[];
			listOrder.shuffle();
		}
		return world[listOrder[indexOrder]];
	}
	
	function Guesser(q,a){ 
		var country=getNextCountry();
	
		if(q == "capitale" && a == "nom"){
			$("#question").html("<h4>"+country[q].UCFirst()+" est la capitale ?</h4>");
		}else if(q == "nom" && a == "capitale"){
			$("#question").html("<h4>quel est la capitale "+country["article"]+country[q].UCFirst()+" ?</h4>");
		}else if(q == "drapeau" && a=="nom"){
			$("#question").html("<img class='qflag' height='100px' src='https://upload.wikimedia.org/wikipedia/commons/"+country[q]+"'></img>");
			$("#question").append("<h4> est le drapeau ?</h4>");
		}else if(q == "nom" && a=="drapeau"){
			$("#question").html("quel est le drapeau "+country["article"]+country[q].UCFirst()+" ?");
		}else{
			$("#question").html(country[q].UCFirst());
		}
		
		var listQ = [];
		listQ.push(country);
		
		while(listQ.length < Math.min(10,listOrder.length)){
			var answer = world[rand(0,worldLength)];
			if(listQ.indexOf(answer) == -1){
				listQ.push(answer);
			}
		}
		listQ.shuffle();
		
		$("#reponse").html("");
		
		listQ.forEach(function(elmnt, i){
			$('#reponse').append(
				"<button "+
				(elmnt[a]==country[a]?"class='goodAnswer' onclick='goodAnswer()'":"onclick='badAnswer(this)'")+
				" >"+(a=="nom"?elmnt["article"]:"")+elmnt[a]+"</button>"
			);
			
			
		});
		
		
	}
	
	var awaitForNewResponse = 0
	
	function goodAnswer(){
		if(!awaitForNewResponse){
			awaitForNewResponse = 1;
			$(".goodAnswer").addClass("good");
			indexOrder++;
			setTimeout(function(){
				Guesser(questionwanted,answerwanted);
				awaitForNewResponse=0;
			},1000);
		}
	}
	
	function badAnswer(elmnt){
		if(!awaitForNewResponse){
			awaitForNewResponse = 1;
			badAnswerList.push(listOrder[indexOrder]);
			$(elmnt).addClass("wrong");
			$(".goodAnswer").addClass("good");
			indexOrder++;
			setTimeout(function(){
				Guesser(questionwanted,answerwanted);
				awaitForNewResponse=0;
			},1000);
		}
	}
	
	
	
	
	
	
		
	</script>
</body>
</html>